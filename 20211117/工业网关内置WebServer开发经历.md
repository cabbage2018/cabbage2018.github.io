 ## 从一个工业网关内置Web Server出发  ##
不会别的，只会写bug:) 
我打算利用这样一个工程来学习Javascript / Node.js 的Web 前后端编程。实际上我打算不提这个名词的，因为我想将网站设计成一个整体，但是在引入Jsonwebtoken 这个技术时遇到了困难。研究了一番后发现，前后端原来不是人为能够决定的排除特定的命名它们是必然的存在，只不过工程师选择了这么样的术语来称呼。后端指服务器这个比较好理解，实际上也是服务器生成了所有的前端网页 - 不管你乐意不乐意，网页（姑且不提前端这个概念）就像编程时用到的回调函数一样，不仅包含了静态文本和图片，最重要的是掺入了验证令牌和脚本。这样看来网页是后端生成的，怎么能和它平起平坐呢？ 说实话也就是一个区分而已可能不必介意。这个结构又让我想到了一个工业网关的设计- 它引入一个配置文件，这个文件里的设备树形结构的根节点竟然是自己，彻底晕掉了，配置文件的自己不能修改自己的IP地址而是必须进入到硬件的自己的配置里面去修改自己的IP地址。。。 我的脑子已经不好使了算了算了不描述这么反人类的设计。所以在我没接触到JWT 和SSO 这样的技术概念的时候我反感这种前后端的设计，觉得有一天我自己来做就把这两个桥是桥路是路整整清楚。目前看来这个理想做不到了。无论如何简单的网页即便是静态html 这样的如果要在请求头里植入服务器分发的令牌（token）也需要动用脚本把函数调用链条推进到服务器端的程序。从这个意义上说我明白了什么是真正的静态网页什么是动态网页。静态网页就是真的内容是静态的，下发给浏览器就不再去验证它和响应它，服务端不再用函数去响应该网页。当然现今世界里严格来说没有这样的东西。只有工业网关里倒是可以将某个时刻的设备状态和数据切片做成一个静态网页呈现。与此相对，如果甲方说这样不好必须让数据实时展现，OK，于是你在网页里加个定时器每秒去刷新数据；或者利用ajax 回调动态展示后台数据。这些都牵涉到服务端代码的执行。

对了后台不仅仅指数据库，也包括硬件的数据，例如来自IO 或者协议的数据。除此之外没了。

### 网站的核心功能 ###
这是开发之前每人都必须要问清楚的。通常来说工业网关的目标是展示数据。这个描述非常简单，但是甲方和一些宣称自己不懂技术的人往往往这个描述上加上不要钱的定语修饰，例如
- 快速的
- 高速更新
- 差不多实时的
- 近实时的
- 实时的
这是性能维度； 同时，因为开发这类内部使用的产品不要钱（要钱就是良好的商业而免费的东西我总觉得助长的就是暴力愚蠢这也就是如来为什么让孙悟空他们取西经的本意佛只渡有缘人）脑洞往往可以大开，于是一次次的产品需求和设计会议上就会有以下内容慢慢的满满的慢慢的渐渐的进来：
+ 支持10个设备
+ 支持15个设备
+ 支持20个设备
+ 支持25个设备
+ 支持30个设备
+ 支持50个设备
+ 支持100个设备
+ 支持10000个设备
只要产品没做出来这个数量还可以往上增加。因为他在描述这个设备点位时会说我不要求时效性，意思是每秒钟采样一个设备你们慢慢采不就得了，时效性在部署时却又会回到实时要求上来-来来来，你看这个领导来看，这个跳闸信号过了30秒才上来这个说不过去吧~ 况且，他不是很懂吗！所以谦虚的人最可怕，他是项目的杀手，国内的客户甲方不少擅长这类的前后矛盾便于最后把项目搞砸拒绝验收。所以在国内这需求分析师真的必须要有权力和地位。
实际上呢这些指标也不是做不到，但是没有商业价值。什么叫做得到？ 让开发工程师每次配20台次设备，那么即使MODBUS 技术也能在100ms 以下采集到这些响应；过一会再轮换20 台设备，就这么做肯定没问题。但是没有商业价值。甲方往往几千块钱CR都不愿承认怎能指望为了实现这个梦幻功能配上一名专职设备连接工程师？ 产品首先要固定，项目要验收，最讨厌对任何问题都回答没问题技术上能做到。什么叫技术上什么叫现实上。
这里设备的概念也有很多讲究或者叫猫腻，可能刚开始需求方定义30个点位进行周期采数，随着项目的开展一个能源管理EMS 项目觉得不够需要温度、录波、谐波失真、无功功率这些都要采了。

### 怎么实现 ###
成功的产品故事都是由生产方强力定义明确的产品来生产和演进。一个产品型号20年畅销全球，绝对是设计的功力。这里面以前可是没有软件什么事的（:(）机械，材料，结构，外观这些唱了主角。成功的背后并没有语言和架构以及脚手架什么事。我于是随便选择了一个Node以及Express，因为国内的搜索引擎只能搜到这些。再套上一个易懂的前端模板叫做EJS。 